# Hubert (Main listener)
hubert:
  build: worker/
  links:
    - cassandra
  volumes:
    - .:/usr/src/app
  command: ./bin/hubert

# Hubert Machine Learning
ml:
  build: script/
  links:
    - cassandra
    - rabbitmq:hubert.rabbitmq
  volumes:
    - ./script:/usr/src/app

# Queue Processor
processor:
  build: worker/
  links:
    - rabbitmq:hubert
  volumes:
    - .:/usr/src/app
  command: ./bin/processor

# RabbitMQ
rabbitmq:
  image: rabbitmq:3.6
  hostname: hubert.rabbitmq
  environment:
    - RABBITMQ_NODENAME=hubert@hubert.rabbitmq
    - RABBITMQ_ERLANG_COOKIE=hubert-cookie
    - RABBITMQ_DEFAULT_USER=hubert
    - RABBITMQ_DEFAULT_PASS=hubert

# Cassandra
cassandra:
  build: cassandra/
  expose:
    - "9042"
